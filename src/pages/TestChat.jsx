import React, { useEffect, useState } from "react";

export const TestChat = () => {
    const [chat, setChat] = useState({ "data": [{ "id": 214, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 214", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-08T12:16:51.000Z", "updatedAt": "2025-08-08T12:16:51.000Z" }, { "id": 213, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 213", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-08T11:16:51.000Z", "updatedAt": "2025-08-08T11:16:51.000Z" }, { "id": 212, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 212", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-08T10:16:51.000Z", "updatedAt": "2025-08-08T10:16:51.000Z" }, { "id": 211, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 211", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-08T09:16:51.000Z", "updatedAt": "2025-08-08T09:16:51.000Z" }, { "id": 210, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 210", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-08T08:16:51.000Z", "updatedAt": "2025-08-08T08:16:51.000Z" }, { "id": 209, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 209", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-08T07:16:51.000Z", "updatedAt": "2025-08-08T07:16:51.000Z" }, { "id": 208, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 208", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-08T06:16:51.000Z", "updatedAt": "2025-08-08T06:16:51.000Z" }, { "id": 207, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 207", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-08T05:16:51.000Z", "updatedAt": "2025-08-08T05:16:51.000Z" }, { "id": 206, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 206", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-08T05:16:51.000Z", "updatedAt": "2025-08-08T05:16:51.000Z" }, { "id": 205, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 205", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-07T06:16:51.000Z", "updatedAt": "2025-08-07T06:16:51.000Z" }, { "id": 204, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 204", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-07T06:16:51.000Z", "updatedAt": "2025-08-07T06:16:51.000Z" }, { "id": 203, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 203", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-07T05:16:51.000Z", "updatedAt": "2025-08-07T05:16:51.000Z" }, { "id": 202, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 202", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-07T05:16:51.000Z", "updatedAt": "2025-08-07T05:16:51.000Z" }, { "id": 201, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 201", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-08-07T05:16:51.000Z", "updatedAt": "2025-08-07T05:16:51.000Z" }, { "id": 80, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 4-10 from 15 to 9", "type": "text", "revoked": false, "seen": false, "createdAt": "2025-07-09T01:13:13.000Z", "updatedAt": "2025-07-09T01:13:13.000Z" }, { "id": 79, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 4-10 from 9 to 15", "type": "text", "revoked": false, "seen": false, "createdAt": "2025-07-09T00:42:26.000Z", "updatedAt": "2025-07-09T00:42:26.000Z" }, { "id": 78, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 4-9 from 15 to 9", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-09T00:41:12.000Z", "updatedAt": "2025-07-09T00:41:12.000Z" }, { "id": 77, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 4-9 from 9 to 15", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-09T00:09:45.000Z", "updatedAt": "2025-07-09T00:09:45.000Z" }, { "id": 76, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 4-8 from 15 to 9", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T23:18:04.000Z", "updatedAt": "2025-07-08T23:18:04.000Z" }, { "id": 75, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 4-8 from 9 to 15", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T22:22:44.000Z", "updatedAt": "2025-07-08T22:22:44.000Z" }, { "id": 74, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 4-7 from 15 to 9", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T22:08:05.000Z", "updatedAt": "2025-07-08T22:08:05.000Z" }, { "id": 73, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 4-7 from 9 to 15", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T21:42:26.000Z", "updatedAt": "2025-07-08T21:42:26.000Z" }, { "id": 72, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 4-6 from 15 to 9", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T20:44:53.000Z", "updatedAt": "2025-07-08T20:44:53.000Z" }, { "id": 71, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 4-6 from 9 to 15", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T19:57:52.000Z", "updatedAt": "2025-07-08T19:57:52.000Z" }, { "id": 70, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 4-5 from 15 to 9", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T18:59:00.000Z", "updatedAt": "2025-07-08T18:59:00.000Z" }, { "id": 69, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 4-5 from 9 to 15", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T18:16:54.000Z", "updatedAt": "2025-07-08T18:16:54.000Z" }, { "id": 68, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 4-4 from 15 to 9", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T17:26:42.000Z", "updatedAt": "2025-07-08T17:26:42.000Z" }, { "id": 67, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 4-4 from 9 to 15", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T17:17:23.000Z", "updatedAt": "2025-07-08T17:17:23.000Z" }, { "id": 66, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 4-3 from 15 to 9", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T16:58:55.000Z", "updatedAt": "2025-07-08T16:58:55.000Z" }, { "id": 65, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 4-3 from 9 to 15", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T16:31:35.000Z", "updatedAt": "2025-07-08T16:31:35.000Z" }, { "id": 64, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 4-2 from 15 to 9", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T15:32:31.000Z", "updatedAt": "2025-07-08T15:32:31.000Z" }, { "id": 63, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 4-2 from 9 to 15", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T15:03:31.000Z", "updatedAt": "2025-07-08T15:03:31.000Z" }, { "id": 62, "senderId": 15, "receiverId": 9, "fileId": null, "content": "Mock message 4-1 from 15 to 9", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T14:35:12.000Z", "updatedAt": "2025-07-08T14:35:12.000Z" }, { "id": 61, "senderId": 9, "receiverId": 15, "fileId": null, "content": "Mock message 4-1 from 9 to 15", "type": "text", "revoked": false, "seen": true, "createdAt": "2025-07-08T13:38:00.000Z", "updatedAt": "2025-07-08T13:38:00.000Z" }] });
    let lastDate = null;
    useEffect(() => {
        console.log(chat.data);
    }, []);
    return (
        <div>
            {[...chat.data].reverse().map((msg, index, arr) => {
                const date = new Date(msg.createdAt);
                const itemDate = date.toLocaleDateString("vi-VN");
                const itemTime = date.toLocaleTimeString("vi-VN", { hour12: false });

                // Nếu là tin đầu tiên hoặc khác ngày tin trước đó
                if (index === 0 || new Date(arr[index - 1].createdAt).toLocaleDateString("vi-VN") !== itemDate) {
                    return (
                        <React.Fragment key={msg.id || index}>
                            <h3>{itemDate}</h3>
                            <div>{itemTime}</div>
                        </React.Fragment>
                    );
                }

                return <div key={msg.id || index}>{itemTime}</div>;
            })}
        </div>
    );

};
